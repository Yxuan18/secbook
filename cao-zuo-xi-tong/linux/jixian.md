# 基线检查

## 1、身份鉴别

### 1、口令复杂度

| 项目 | 详情 |
| :--- | :--- |
| 说明 | 对于采用静态口令认证技术的设备，口令长度至少 8 位，并至少包括数字、 小写字母、大写字母和特殊符号中的三种。增强口令复杂度是为了增加攻击 者破解密码的难度和时间成本。 |
| 检测步骤 | 1、执行：more /etc/pam.d/system-auth 检查文件中是否对 pam\_cracklib.so 的参数进行了正确设置；  2、执行：awk -F: '\($2 == ""\) { print $1 }' /etc/shadow，检查是否存在空口令 帐号。  |
| 符合性依据 | 参考配置操作 \# cat /etc/pam.d/system-auth，找到 password 模块接口的配置部分，找到类 似如下的配置行：  password requisite /lib/security/$ISA/pam\_cracklib.so minlen =8 参数说明如下：  1、retry=N，确定用户创建密码时允许重试的次数；  2、minlen=N，确定密码最小长度要求，事实上，在默认配置下，此参数代 表密码最小长度为 N-1；  3、dcredit=N，当 N 小于 0 时，代表新密码中数字字符数量不得少于（N）个。例如，dcredit=-2 代表密码中要至少包含两个数字字符；  4、ucredit=N，当 N 小于 0 时，代表则新密码中大写字符数量不得少于（N）个；  5、lcredit=N，当 N 小于 0 时，代表则新密码中小写字符数量不得少于（-N） 个；  6、ocredit=N，当 N 小于 0 时，代表则新密码中特殊字符数量不得少于（ N）个；2.不存在空口令帐号。  shadow 文件第二个字段为空即存在空口令 |
| 影响性分析 | 加固操作对业务无影响，加固操作对业务无影响,但是操作失误会导致系统认 证错误，无法正常登陆。 建议在修改配置文件前，对原配置文件进行备份 cp xx xx20190503.bak |

### 

### 

### 2、口令生存期

| 项目 | 详情 |
| :--- | :--- |
| 说明 | 对于采用静态口令认证技术的设备，帐户口令的生存期不长于 90 天。最短期 限为 6 天。  由于所有密码理论上都是可以被破解的，只是时间长短问题，设置口令生存期 是为了让攻击者破解密码后密码已经更新 |
| 检测步骤 | 执行：more /etc/login.defs，检查 PASS\_MAX\_DAYS、 PASS\_MIN\_DAYS、 PASS\_WARN\_AGE 参数 |
| 符合性依据 | 参考配置操作  用 vi 编辑/etc/login.defs 文件中配置：  PASS\_MAX\_DAYS 90\#新建用户的口令最长使用天数  PASS\_MIN\_DAYS 6\#新建用户的口令最短使用天数  PASS\_WARN\_AGE 7\#新建用户的口令到期提前提醒天数 |

### 

### 

### 3、默认账户

| 项目 | 详情 |
| :--- | :--- |
| 说明 | 攻击者一般都从系统默认帐户进行尝试破解。应锁定与设备运行、维护等工作无关的账户 |
| 检测步骤 | 查看锁定用户：  \# cat /etc/passwd，查看哪些账户的 shell 域中为 nologin |
| 符合性依据 | 系统默认帐户应被禁止登录或者锁定如下账号：  lp, sync, shutdown, halt, news, uucp, operator, games, gopher 。  参考配置操作：  锁定用户：  修改/etc/passwd 文件，将需要锁定的用户的 shell 域设为 nologin；  通过\#passwd –l username 锁定账户；  只有具备超级用户权限的使用者方可使用\#passwd –l username 锁定用户,用 \#passwd –d username 解锁后原有密码失效，登录需输入新密码 |
| 回退操作 | 账户解锁：  \# usermod -U username 或\# passwd -u username |

### 

### 

### 4、共享账户

| 项目 | 详情 |
| :--- | :--- |
| 说明 | 系统需按照实际用户分配账户；  避免不同用户间共享账户。 |
| 检测步骤 | 使用命令 cat /etc/passwd 查看当前所有用户的信息，与管理员确认是否有共 享账户情况存在 |
| 符合性依据 | 若存在账户共享的情况，则低于安全要求；  参考配置操作：  cat /etc/passwd 查看当前所有用户的情况；  如需建立用户，参考如下：  \#useradd username \#创建账户  \#passwd username \#设置密码  使用该命令为不同的用户分配不同的账户，设置不同的口令及权限信息等。 |

### 

### 

### 5、FTP账户

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

### 6、超级用户控制

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

### 7、用户口令策略

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

## 2、访问控制

### 1、SSH登录维护

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

### 2、SSH-ROOT远程登录限制

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

### 3、登录超时设置

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

### 4、关键目录权限

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

### 5、用户缺省权限

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

## 3、安全审计

### 1、系统日志审计

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

### 

### 2、日志远程存储

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

## 4、端口管理

### 1、关闭不必要服务

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

## 5、其他安全配置

### 1、系统core dump状态

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

### 2、补丁更新

| 项目 | 详情 |
| :--- | :--- |
|  |  |
|  |  |
|  |  |

### 

### 

